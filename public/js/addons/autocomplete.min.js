/*! UIkit 2.6.0 | http://www.getuikit.com | (c) 2014 YOOtheme | MIT License */

!function(a){"function"==typeof define&&define.amd&&define("uikit-autocomplete",["uikit"],function(){return jQuery.UIkit.autocomplete||a(window,window.jQuery,window.jQuery.UIkit)}),window&&window.jQuery&&window.jQuery.UIkit&&a(window,window.jQuery,window.jQuery.UIkit)}(function(a,b,c){var d=function(a,e){var f=b(a);f.data("autocomplete")||(this.options=b.extend({},d.defaults,e),this.element=f,this.dropdown=f.find(".uk-dropdown"),this.template=f.find('script[type="text/autocomplete"]').html(),this.template=c.Utils.template(this.template||this.options.template),this.input=f.find("input:first").attr("autocomplete","off"),this.element.data("autocomplete",this),this.dropdown.length||(this.dropdown=b('<div class="uk-dropdown"></div>').appendTo(f)),this.options.flipDropdown&&this.dropdown.addClass("uk-dropdown-flip"),this.init())};return b.extend(d.prototype,{visible:!1,value:null,selected:null,init:function(){var a=this,d=!1,e=c.Utils.debounce(function(){return d?d=!1:void a.trigger()},this.options.delay);this.input.on({keydown:function(b){if(b&&b.which&&!b.shiftKey)switch(b.which){case 13:b.preventDefault(),d=!0,a.select();break;case 38:b.preventDefault(),a.pick("prev");break;case 40:b.preventDefault(),a.pick("next");break;case 27:case 9:a.hide()}},keyup:e,blur:function(){setTimeout(function(){a.hide()},200)}}),this.dropdown.on("click",".uk-autocomplete-results > *",function(){a.select()}),this.dropdown.on("mouseover",".uk-autocomplete-results > *",function(){a.pick(b(this))})},trigger:function(){var a=this,b=this.value;return this.value=this.input.val(),this.value.length<this.options.minLength?this.hide():(this.value!=b&&a.request(),this)},pick:function(a){var b=this.dropdown.find(".uk-autocomplete-results").children(":not(."+this.options.skipClass+")"),c=!1;if("string"==typeof a||a.hasClass(this.options.skipClass)){if("next"==a||"prev"==a)if(this.selected){var d=b.index(this.selected);c=b.eq("next"==a?d+1<b.length?d+1:0:0>d-1?b.length-1:d-1)}else c=b["next"==a?"first":"last"]()}else c=a;c&&c.length&&(this.selected=c,b.removeClass(this.options.hoverClass),this.selected.addClass(this.options.hoverClass))},select:function(){if(this.selected){var a=this.selected.data();this.element.trigger("autocomplete-select",[a,this]),a.value&&this.input.val(a.value),this.hide()}},show:function(){return this.visible?void 0:(this.visible=!0,this.element.addClass("uk-open"),this)},hide:function(){return this.visible?(this.visible=!1,this.element.removeClass("uk-open"),this):void 0},request:function(){var a=this,c=function(b){b&&a.render(b),a.element.removeClass(a.options.loadingClass)};if(this.element.addClass(this.options.loadingClass),this.options.source){var d=this.options.source;switch(typeof this.options.source){case"function":this.options.source.apply(this,[c]);break;case"object":if(d.length){var e=[];d.forEach(function(b){b.value&&-1!=b.value.toLowerCase().indexOf(a.value.toLowerCase())&&e.push(b)}),c(e)}break;case"string":var f={};f[this.options.param]=this.value,b.ajax({url:this.options.source,data:f,type:this.options.method,dataType:"json",complete:function(a){c(a.responseJSON||[])}});break;default:c(null)}}else this.element.removeClass(a.options.loadingClass)},render:function(a){return this.dropdown.empty(),this.selected=!1,this.options.renderer?this.options.renderer.apply(this,[a]):a&&a.length&&(this.dropdown.append(this.template({items:a})),this.show()),this}}),d.defaults={minLength:3,param:"search",method:"post",delay:300,loadingClass:"uk-loading",flipDropdown:!1,skipClass:"uk-skip",hoverClass:"uk-active",source:null,renderer:null,template:'<ul class="uk-nav uk-nav-autocomplete uk-autocomplete-results">{{~items}}<li data-value="{{$item.value}}"><a>{{$item.value}}</a></li>{{/items}}</ul>'},c.autocomplete=d,b(document).on("focus.autocomplete.uikit","[data-uk-autocomplete]",function(){var a=b(this);if(!a.data("autocomplete")){new d(a,c.Utils.options(a.attr("data-uk-autocomplete")))}}),d});