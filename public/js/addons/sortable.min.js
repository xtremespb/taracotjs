/*! UIkit 2.6.0 | http://www.getuikit.com | (c) 2014 YOOtheme | MIT License */

!function(a){"function"==typeof define&&define.amd&&define("uikit-sortable",["uikit"],function(){return jQuery.fn.uksortable||a(window.jQuery,jQuery.UIkit,window,document)}),window&&window.jQuery&&window.jQuery.UIkit&&a(window.jQuery,jQuery.UIkit,window,document)}(function(a,b,c,d){function e(b,d){var e=a(b);e.data("uksortable")||(this.w=a(c),this.el=e,this.options=a.extend({},a.fn.uksortable.defaults,d),this.tplempty='<div class="'+this.options.emptyClass+'"/>',this.el.find(">"+this.options.itemNodeName).addClass(this.options.listitemClass).end().find("ul:not(.ignore-list)").addClass(this.options.listClass).find(">li").addClass(this.options.listitemClass),this.el.children(this.options.itemNodeName).length||this.el.append(this.tplempty),this.el.data("uksortable",this),this.el.data("uksortable-id","ID"+(new Date).getTime()+"RAND"+Math.ceil(1e5*Math.random())),this.init())}var f="ontouchstart"in c,g=a("html"),h=[],i=function(){var a=d.createElement("div"),b=d.documentElement;if(!("pointerEvents"in a.style))return!1;a.style.pointerEvents="auto",a.style.pointerEvents="x",b.appendChild(a);var e=c.getComputedStyle&&"auto"===c.getComputedStyle(a,"").pointerEvents;return b.removeChild(a),!!e}(),j=f?"touchstart":"mousedown",k=f?"touchmove":"mousemove",l=f?"touchend":"mouseup",m=f?"touchcancel":"mouseup";return e.prototype={init:function(){var b=this;b.reset(),b.el.data("uksortable-group",this.options.group),b.placeEl=a('<div class="'+b.options.placeClass+'"/>'),a.each(this.el.find(b.options.itemNodeName),function(c,d){b.setParent(a(d))}),b.el.on("click","[data-sortable-action]",function(c){if(!b.dragEl&&(f||0===c.button)){c.preventDefault();var d=a(c.currentTarget),e=d.data("sortableAction"),g=d.closest(b.options.itemNodeName);"collapse"===e&&b.collapseItem(g),"expand"===e&&b.expandItem(g),"toggle"===e&&b.toggleItem(g)}});var d=function(c){var d=a(c.target);if(!d.hasClass(b.options.handleClass)){if(d.closest("."+b.options.noDragClass).length)return;d=d.closest("."+b.options.handleClass)}!d.length||b.dragEl||!f&&0!==c.button||f&&1!==c.touches.length||(c.preventDefault(),b.dragStart(f?c.touches[0]:c))},e=function(a){b.dragEl&&(a.preventDefault(),b.dragMove(f?a.touches[0]:a))},g=function(a){b.dragEl&&(a.preventDefault(),b.dragStop(f?a.touches[0]:a))};f?(b.el[0].addEventListener(j,d,!1),c.addEventListener(k,e,!1),c.addEventListener(l,g,!1),c.addEventListener(m,g,!1)):(b.el.on(j,d),b.w.on(k,e),b.w.on(l,g))},serialize:function(){var b,c=0,d=this;return step=function(b,c){var e=[],f=b.children(d.options.itemNodeName);return f.each(function(){var b=a(this),f=a.extend({},b.data()),g=b.children(d.options.listNodeName);g.length&&(f.children=step(g,c+1)),e.push(f)}),e},b=step(d.el,c)},list:function(b){var c=[],d=this,e=0,b=a.extend({},d.options,b),f=function(d,e,g){var h=d.children(b.itemNodeName);h.each(function(d){var h=a(this),i=a.extend({parent_id:g?g:null,depth:e,order:d},h.data()),j=h.children(b.listNodeName);c.push(i),j.length&&f(j,e+1,h.data(b.idProperty||"id"))})};return f(d.el,e),c},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null;for(var a=0;a<h.length;a++)h[a].children().length||h[a].append(this.tplempty);h=[]},toggleItem:function(a){this[a.hasClass(this.options.collapsedClass)?"expandItem":"collapseItem"](a)},expandItem:function(a){a.removeClass(this.options.collapsedClass)},collapseItem:function(a){var b=a.children(this.options.listNodeName);b.length&&a.addClass(this.options.collapsedClass)},expandAll:function(){var b=this;b.el.find(b.options.itemNodeName).each(function(){b.expandItem(a(this))})},collapseAll:function(){var b=this;b.el.find(b.options.itemNodeName).each(function(){b.collapseItem(a(this))})},setParent:function(a){a.children(this.options.listNodeName).length&&a.addClass("uk-parent")},unsetParent:function(a){a.removeClass("uk-parent "+this.options.collapsedClass),a.children(this.options.listNodeName).remove()},dragStart:function(b){var c=this.mouse,e=a(b.target),f=e.closest(this.options.itemNodeName),h=f.offset();this.placeEl.css("height",f.height()),c.offsetX=b.pageX-h.left,c.offsetY=b.pageY-h.top,c.startX=c.lastX=h.left,c.startY=c.lastY=h.top,this.dragRootEl=this.el,this.dragEl=a(d.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",f.width()),this.tmpDragOnSiblings=[f[0].previousSibling,f[0].nextSibling],f.after(this.placeEl),f[0].parentNode.removeChild(f[0]),f.appendTo(this.dragEl),a(d.body).append(this.dragEl),this.dragEl.css({left:h.left,top:h.top});var i,j,k=this.dragEl.find(this.options.itemNodeName);for(i=0;i<k.length;i++)j=a(k[i]).parents(this.options.listNodeName).length,j>this.dragDepth&&(this.dragDepth=j);g.addClass(this.options.movingClass)},dragStop:function(){var a=this.dragEl.children(this.options.itemNodeName).first();a[0].parentNode.removeChild(a[0]),this.placeEl.replaceWith(a),this.dragEl.remove(),(this.tmpDragOnSiblings[0]!=a[0].previousSibling||this.tmpDragOnSiblings[0]!=a[0].previousSibling)&&(this.el.trigger("sortable-change",[a,this.hasNewRoot?"added":"moved"]),this.hasNewRoot&&this.dragRootEl.trigger("sortable-change",[a,"removed"])),this.reset(),g.removeClass(this.options.movingClass)},dragMove:function(b){var e,f,g,j,k,l=this.options,m=this.mouse;this.dragEl.css({left:b.pageX-m.offsetX,top:b.pageY-m.offsetY}),m.lastX=m.nowX,m.lastY=m.nowY,m.nowX=b.pageX,m.nowY=b.pageY,m.distX=m.nowX-m.lastX,m.distY=m.nowY-m.lastY,m.lastDirX=m.dirX,m.lastDirY=m.dirY,m.dirX=0===m.distX?0:m.distX>0?1:-1,m.dirY=0===m.distY?0:m.distY>0?1:-1;var n=Math.abs(m.distX)>Math.abs(m.distY)?1:0;if(!m.moving)return m.dirAx=n,void(m.moving=!0);m.dirAx!==n?(m.distAxX=0,m.distAxY=0):(m.distAxX+=Math.abs(m.distX),0!==m.dirX&&m.dirX!==m.lastDirX&&(m.distAxX=0),m.distAxY+=Math.abs(m.distY),0!==m.dirY&&m.dirY!==m.lastDirY&&(m.distAxY=0)),m.dirAx=n,m.dirAx&&m.distAxX>=l.threshold&&(m.distAxX=0,g=this.placeEl.prev(l.itemNodeName),m.distX>0&&g.length&&!g.hasClass(l.collapsedClass)&&(e=g.find(l.listNodeName).last(),k=this.placeEl.parents(l.listNodeName).length,k+this.dragDepth<=l.maxDepth&&(e.length?(e=g.children(l.listNodeName).last(),e.append(this.placeEl)):(e=a("<"+l.listNodeName+"/>").addClass(l.listClass),e.append(this.placeEl),g.append(e),this.setParent(g)))),m.distX<0&&(j=this.placeEl.next(l.itemNodeName),j.length||(f=this.placeEl.parent(),this.placeEl.closest(l.itemNodeName).after(this.placeEl),f.children().length||this.unsetParent(f.parent()))));var o=!1;if(i||(this.dragEl[0].style.visibility="hidden"),this.pointEl=a(d.elementFromPoint(b.pageX-d.body.scrollLeft,b.pageY-(c.pageYOffset||d.documentElement.scrollTop))),i||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(l.handleClass))this.pointEl=this.pointEl.closest(l.itemNodeName);else{var p=this.pointEl.closest("."+l.itemClass);p.length&&(this.pointEl=p.closest(l.itemNodeName))}if(this.pointEl.hasClass(l.emptyClass))o=!0;else if(this.pointEl.data("uksortable")&&!this.pointEl.children().length)o=!0,this.pointEl=a(this.tplempty).appendTo(this.pointEl);else if(!this.pointEl.length||!this.pointEl.hasClass(l.listitemClass))return;var q=this.el,r=this.pointEl.closest("."+this.options.listBaseClass),s=q[0]!==this.pointEl.closest("."+this.options.listBaseClass)[0],t=r;if(!m.dirAx||s||o){if(s&&l.group!==t.data("uksortable-group"))return;if(h.push(q),k=this.dragDepth-1+this.pointEl.parents(l.listNodeName).length,k>l.maxDepth)return;var u=b.pageY<this.pointEl.offset().top+this.pointEl.height()/2;f=this.placeEl.parent(),o?this.pointEl.replaceWith(this.placeEl):u?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),f.children().length||f.data("uksortable")||this.unsetParent(f.parent()),this.dragRootEl.find(l.itemNodeName).length||this.dragRootEl.children().length||this.dragRootEl.append(this.tplempty),s&&(this.dragRootEl=r,this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}}},a.fn.uksortable=function(b){var c=this,d=this;return c.each(function(){var c=a(this),f=c.data("uksortable");f?"string"==typeof b&&"function"==typeof f[b]&&(d=f[b]()):f=new e(c,b)}),d||c},a.fn.uksortable.defaults={prefix:"uk",listNodeName:"ul",itemNodeName:"li",listBaseClass:"{prefix}-sortable",listClass:"{prefix}-sortable-list",listitemClass:"{prefix}-sortable-list-item",itemClass:"{prefix}-sortable-item",dragClass:"{prefix}-sortable-list-dragged",movingClass:"{prefix}-sortable-moving",handleClass:"{prefix}-sortable-handle",collapsedClass:"{prefix}-collapsed",placeClass:"{prefix}-sortable-placeholder",noDragClass:"{prefix}-sortable-nodrag",emptyClass:"{prefix}-sortable-empty",group:0,maxDepth:10,threshold:20},a(d).on("uk-domready",function(){a("[data-uk-sortable]").each(function(){var c=a(this),d=a.extend({},a.fn.uksortable.defaults,b.Utils.options(c.attr("data-uk-sortable")));Object.keys(d).forEach(function(a){-1!=String(d[a]).indexOf("{prefix}")&&(d[a]=d[a].replace("{prefix}",d.prefix))}),c.data("uksortable")||c.uksortable(d)})}),a.fn.uksortable});