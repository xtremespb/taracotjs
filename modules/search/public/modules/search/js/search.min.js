function submitOnEnter(a){var b;if(window.event)b=window.event.keyCode;else{if(!a)return!1;b=a.keyCode?a.keyCode:a.which}return 13==b&&(!window.previousKeyCode||33!=window.previousKeyCode&&34!=window.previousKeyCode&&39!=window.previousKeyCode&&40!=window.previousKeyCode)?!0:(window.previousKeyCode=b,!1)}function getUrlVars(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}var items_per_page=0,current_search_query="";$("#btn_search").click(function(){return $("#search_query").removeClass("uk-form-danger"),$("#search_query").val()?(current_search_query=$("#search_query").val(),taracot_search_loading_indicator(!0),void load_data(1)):void $("#search_query").addClass("uk-form-danger")});var load_data=function(a){a||(a=1),$.ajax({type:"POST",url:"/search/data",data:{query:current_search_query,skip:(a-1)*items_per_page},dataType:"json",success:function(b){$("#search_query").focus(),taracot_search_loading_indicator(!1),1!=b.status?($("#search_pagination").html(""),$("#search_results").html(b.error?b.error:_lang_vars.ajax_failed)):(items_per_page=b.ipp,render_pagination(a,b.total),render_results(b.items,b.total))},error:function(){$("#search_query").focus(),taracot_search_loading_indicator(!1),$("#search_pagination").html(""),$("#search_results").html(_lang_vars.ajax_failed)}})},render_results=function(a,b){$("#search_results").html('<div class="uk-margin-bottom">'+_lang_vars.total_results+": "+b+"</div>");for(var c=0;c<a.length;c++){var d=a[c][0],e=a[c][1],f=a[c][2];$("#search_results").append('<div data-uk-margin><div><a href="'+f+'" class="taracot-search-res-title">'+d+'</a><div><a href="'+f+'" class="taracot-search-res-link">'+window.location.protocol+"//"+window.location.host+f+'</a></div><div class="taracot-search-res-desc uk-margin-bottom">'+e+"</div></div>")}a.length||$("#search_results").html(_lang_vars.no_results)},render_pagination=function(a,b){var c="";$("#search_pagination").html(c),a=parseInt(a);var d=10,e=Math.ceil(b/items_per_page);if(!(2>e)){if(c='<ul class="uk-pagination uk-float-left search-pgnt">',e>d){a>1&&(c+='<li class="search-pgnt-'+(a-1)+'"><a href="#"><i class="uk-icon-angle-double-left"></i></a></li>'),a>3&&(c+='<li class="search-pgnt-1"><a href="#">1</i></a></li>');var f=a-2;1>f&&(f=1),f-1>1&&(c+="<li>...</li>");var g=a+2;g>e&&(g=e);for(var h=f;g>=h;h++)c+='<li class="search-pgnt-'+h+'"><a href="#">'+h+"</a></li>";e-1>g&&(c+="<li><span>...</span></li>"),e-3>=a&&(c+='<li class="search-pgnt-'+e+'"><a href="#">'+e+"</a></li>"),e>a&&(c+='<li class="search-pgnt-'+(a+1)+'"><a href="#"><i class="uk-icon-angle-double-right"></i></a></li>')}else for(var i=1;e>=i;i++)c+='<li class="search-pgnt-'+i+'"><a href="#">'+i+"</a></li>";c+="</ul>",$("#search_pagination").html(c),$(".search-pgnt-"+a).html("<span>"+a+"</span>"),$(".search-pgnt-"+a).addClass("uk-active"),$(".search-pgnt > li").click(pagination_handler)}},pagination_handler=function(){$(this).hasClass("uk-active")||(taracot_search_loading_indicator(!0),load_data($(this).attr("class").replace("search-pgnt-","")))},taracot_search_loading_indicator=function(a){if(a){var b=$("#search_results").offset();$(".taracot-loading").css({top:b.top,left:b.left,width:$("#search_results").width(),height:$("#search_results").height()}),$(".taracot-loading").show(),$("#search_pagination").hide(),$("#btn_search").attr("disabled",!0)}else $(".taracot-loading").hide(),$("#search_pagination").show(),$("#btn_search").attr("disabled",!1)};$("#search_query").bind("keypress",function(a){submitOnEnter(a)&&!$("#btn_search").attr("disabled")&&$("#btn_search").click()}),$(document).ready(function(){$("#search_query").focus();var a=getUrlVars();a&&a.query&&($("#search_query").val(decodeURIComponent(a.query)),$("#btn_search").click())});