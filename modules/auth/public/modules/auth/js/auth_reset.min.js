function submitOnEnter(a){var b;if(window.event)b=window.event.keyCode;else{if(!a)return!1;b=a.keyCode?a.keyCode:a.which}return 13==b&&(!window.previousKeyCode||33!=window.previousKeyCode&&34!=window.previousKeyCode&&39!=window.previousKeyCode&&40!=window.previousKeyCode)?!0:(window.previousKeyCode=b,!1)}var captcha_loading=!1,load_captcha=function(){return"undefined"!=typeof captcha_type&&"png"==captcha_type?void $("#reset_captcha_img").attr("src","/auth/captcha?rnd="+Math.random().toString().replace(".","")):void(captcha_loading||(captcha_loading=!0,$.ajax({type:"POST",url:"/auth/captcha",data:{},dataType:"json",success:function(a){captcha_loading=!1,a.img?$("#reset_captcha_img").attr("src","data:image/jpeg;base64,"+a.img):($("#taracot-reset-error").html(_lang_vars.ajax_failed),$("#taracot-reset-error").show())},error:function(){$("#taracot-reset-error").html(_lang_vars.ajax_failed),$("#taracot-reset-error").show(),captcha_loading=!1}})))};$("#reset_captcha_img").click(load_captcha),$("#reset_captcha").val(""),$("#btn_reset").click(function(){return $("#taracot-reset-error").hide(),$(".taracot-auth-field").removeClass("uk-form-danger"),captcha_req&&!$("#reset_captcha").val().match(/^[0-9]{4}$/)?($("#reset_captcha").addClass("uk-form-danger"),$("#reset_captcha").select(),$("#reset_captcha").focus(),$("#taracot-reset-error").html(_lang_vars.invalid_captcha),void $("#taracot-reset-error").show()):$("#reset_email").val().match(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)?($("#reset_wrap").hide(),$("#reset_loading").show(),$("#taracot-reset-error").hide(),void $.ajax({type:"POST",url:"/auth/reset/process",data:{email:$("#reset_email").val(),captcha:$("#reset_captcha").val()},dataType:"json",success:function(a){1!=a.result?($("#reset_wrap").show(),$("#reset_loading").hide(),$("#reset_captcha").val(""),a.field&&($("#"+a.field).addClass("uk-form-danger"),$("#"+a.field).select(),$("#"+a.field).focus()),$("#captcha_div").show(),captcha_req=!0,a.error&&($("#taracot-reset-error").html(a.error),$("#taracot-reset-error").show()),load_captcha()):($("#reset_loading").hide(),$("#reset_success").show())},error:function(){$("#reset_wrap").show(),$("#reset_loading").hide(),$("#taracot-reset-error").html(_lang_vars.ajax_failed),$("#taracot-reset-error").show(),$("#reset_captcha").val(""),load_captcha()}})):($("#reset_email").addClass("uk-form-danger"),$("#reset_email").focus(),$("#taracot-reset-error").html(_lang_vars.invalid_email_syntax),void $("#taracot-reset-error").show())}),$(".taracot-auth-field").bind("keypress",function(a){submitOnEnter(a)&&($("#btn_reset").click(),a.preventDefault())}),$("#reset_email").focus(),$(document).ready(function(){load_captcha()});