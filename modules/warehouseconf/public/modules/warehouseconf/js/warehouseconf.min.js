!function(a){function b(){document.getElementById("_taracot_loader_image").style.backgroundImage="url("+l+")",document.getElementById("_taracot_loader_image").style.width=h+"px",document.getElementById("_taracot_loader_image").style.height=i+"px",FPS=Math.round(100/g),q=1/FPS,p=setTimeout(c,q/1e3)}function c(){o+=k,n+=1,n>=j&&(o=0,n=0),document.getElementById("_taracot_loader_image")&&(document.getElementById("_taracot_loader_image").style.backgroundPosition=-o+"px 0"),p=setTimeout(c,1e3*q)}function d(a,b){clearTimeout(m),m=0,genImage=new Image,genImage.onload=function(){m=setTimeout(b,0)},genImage.src=a}var e,f=jQuery.extend({},f),g=9,h=100,i=100,j=12,k=100,l="/images/loading.png",m=!1,n=0,o=0,p=!1,q=0,r={init:function(){a("body").append('<div id="_taracot-loading-modal" class="uk-modal"><div class="uk-modal-dialog uk-modal-dialog-frameless" style="background:0;box-shadow:0 0 0px rgba(0,0,0,0);position:absolute;top:50%;left:50%;margin-top:-50px;margin-left:-50px;width:100px;height:100px;"><div id="_taracot_loader_image"></div></div></div>'),e=UIkit.modal("#_taracot-loading-modal",{bgclose:!1,keyboard:!1}),new d(l,b)},show:function(){a("#_taracot-loading-modal").show(),e.show()},hide:function(){e.hide(),a("#_taracot-loading-modal").hide()}};a.loadingIndicator=function(b){return r[b]?r[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" doesn't exists"):r.init.apply(this,arguments)}}(jQuery),!function(a){var b;jQuery&&jQuery.UIkit&&(b=a(jQuery,jQuery.UIkit)),"function"==typeof define&&define.amd&&define("uikit-sortable",["uikit"],function(){return b||a(jQuery,jQuery.UIkit)})}(function(a,b){"use strict";function c(a,b){var c=a.parentNode;if(b.parentNode!=c)return!1;for(var d=a.previousSibling;d&&9!==d.nodeType;){if(d===b)return!0;d=d.previousSibling}return!1}function d(a,b){var c=b;if(c==a)return null;for(;c;){if(c.parentNode===a)return c;if(c=c.parentNode,!c||!c.ownerDocument||11===c.nodeType)break}return null}function e(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}var f,g,h,i,j,k="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,l=!k&&function(){var a=document.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a}();return l=!1,b.component("sortable",{defaults:{warp:!1,animation:150,threshold:10,childClass:"uk-sortable-item",placeholderClass:"uk-sortable-placeholder",overClass:"uk-sortable-over",draggingClass:"uk-sortable-dragged",dragMovingClass:"uk-sortable-moving",dragCustomClass:"",handleClass:!1,stop:function(){},start:function(){},change:function(){}},init:function(){function c(b){return function(c){var e=k&&c.touches&&c.touches[0]||{},f=e.target||c.target;if(k&&document.elementFromPoint&&(f=document.elementFromPoint(c.pageX-document.body.scrollLeft,c.pageY-document.body.scrollTop)),a(f).hasClass(o.options.childClass))b.apply(f,[c]);else if(f!==p){var g=d(p,f);g&&b.apply(g,[c])}}}function m(){l||(k?p.addEventListener("touchmove",y,!1):(p.addEventListener("mouseover",u,!1),p.addEventListener("mouseout",v,!1)),p.addEventListener(k?"touchend":"mouseup",w,!1),document.addEventListener(k?"touchend":"mouseup",x,!1),document.addEventListener("selectstart",e,!1))}function n(){l||(k?p.removeEventListener("touchmove",y,!1):(p.removeEventListener("mouseover",u,!1),p.removeEventListener("mouseout",v,!1)),p.removeEventListener(k?"touchend":"mouseup",w,!1),document.removeEventListener(k?"touchend":"mouseup",x,!1),document.removeEventListener("selectstart",e,!1))}var o=this,p=this.element[0],q=null,r=null;l?this.element.children().attr("draggable","true"):this.element.on("mousedown touchstart","a[href]",function(b){b.ctrlKey||b.metaKey||b.shiftKey||(i=a(this),b.preventDefault())}).on("click","a[href]",function(b){return b.ctrlKey||b.metaKey||b.shiftKey?void 0:(i=a(this),b.stopImmediatePropagation(),!1)});var s=c(function(b){g=!1,h=!1;var c=a(b.target);if(o.element.children(),k||2!=b.button){if(o.options.handleClass){var d=c.hasClass(o.options.handleClass)?c:c.closest("."+o.options.handleClass,p);if(!d.length)return}b.dataTransfer&&(b.dataTransfer.effectAllowed="move",b.dataTransfer.dropEffect="move",b.dataTransfer.setData("Text","*")),q=this,f&&f.remove();var e=a(q),i=e.offset();j={pos:{x:b.pageX,y:b.pageY},threshold:o.options.threshold,apply:function(){f=a('<div class="'+[o.options.draggingClass,o.options.dragCustomClass].join(" ")+'"></div>').css({display:"none",top:i.top,left:i.left,width:e.width(),height:e.height(),padding:e.css("padding")}).data("mouse-offset",{left:i.left-parseInt(b.pageX,10),top:i.top-parseInt(b.pageY,10)}).append(e.html()).appendTo("body"),f.$current=e,f.$sortable=o,m(),o.options.start(this,q),o.trigger("uk.sortable.start",[o,q]),j=!1}},l||b.preventDefault()}}),t=c(function(a){return q?(a.preventDefault&&a.preventDefault(),!1):!0}),u=c(a.UIkit.Utils.debounce(function(){if(!q||q===this)return!0;var b=o.dragenterData(this);return o.dragenterData(this,b+1),0===b&&(a(this).addClass(o.options.overClass),o.options.warp||o.moveElementNextTo(q,this)),!1}),40),v=c(function(){var b=o.dragenterData(this);o.dragenterData(this,b-1),o.dragenterData(this)||(a(this).removeClass(o.options.overClass),o.dragenterData(this,!1))}),w=c(function(a){if("drop"===a.type&&(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault()),h||o.options.warp){if(o.options.warp){var c=q.nextSibling;this.parentNode.insertBefore(q,this),this.parentNode.insertBefore(this,c),b.Utils.checkDisplay(o.element.parent())}o.options.change(this,q),o.trigger("uk.sortable.change",[o,q])}}),x=function(){q=null,r=null,o.element.children().each(function(){1===this.nodeType&&(a(this).removeClass(o.options.overClass).removeClass(o.options.placeholderClass).removeClass(o.options.childClass),o.dragenterData(this,!1))}),a("html").removeClass(o.options.dragMovingClass),n(),o.options.stop(this),o.trigger("uk.sortable.stop",[o]),f.remove(),f=null},y=c(function(b){return q&&q!==this&&r!==this?(o.element.children().removeClass(o.options.overClass),r=this,o.options.warp?a(this).addClass(o.options.overClass):o.moveElementNextTo(q,this),e(b)):!0});l?(p.addEventListener("dragstart",s,!1),p.addEventListener("dragenter",u,!1),p.addEventListener("dragleave",v,!1),p.addEventListener("drop",w,!1),p.addEventListener("dragover",t,!1),p.addEventListener("dragend",x,!1)):p.addEventListener(k?"touchstart":"mousedown",s,!1)},dragenterData:function(b,c){return b=a(b),1==arguments.length?parseInt(b.attr("data-child-dragenter"),10)||0:void(c?b.attr("data-child-dragenter",Math.max(0,c)):b.removeAttr("data-child-dragenter"))},moveElementNextTo:function(d,e){h=!0;var f=this,g=a(d).parent().css("min-height",""),i=c(d,e)?e:e.nextSibling,j=g.children(),k=j.length;return f.options.warp||!f.options.animation?(e.parentNode.insertBefore(d,i),void b.Utils.checkDisplay(f.element.parent())):(g.css("min-height",g.height()),j.stop().each(function(){var b=a(this),c=b.position();c.width=b.width(),b.data("offset-before",c)}),e.parentNode.insertBefore(d,i),b.Utils.checkDisplay(f.element.parent()),j=g.children().each(function(){var b=a(this);b.data("offset-after",b.position())}).each(function(){var b=a(this),c=b.data("offset-before");b.css({position:"absolute",top:c.top,left:c.left,"min-width":c.width})}),void j.each(function(){var c=a(this),d=(c.data("offset-before"),c.data("offset-after"));c.css("pointer-events","none").width(),setTimeout(function(){c.animate({top:d.top,left:d.left},f.options.animation,function(){c.css({position:"",top:"",left:"","min-width":"","pointer-events":""}).removeClass(f.options.overClass).attr("data-child-dragenter",""),k--,k||(g.css("min-height",""),b.Utils.checkDisplay(f.element.parent()))})},0)}))}}),b.ready(function(c){a("[data-uk-sortable]",c).each(function(){var c=a(this);c.data("sortable")||b.sortable(c,b.Utils.options(c.attr("data-uk-sortable")))})}),a("html").on("mousemove touchmove",function(c){if(j){var d=c.originalEvent.targetTouches?c.originalEvent.targetTouches[0]:c;(Math.abs(d.pageX-j.pos.x)>j.threshold||Math.abs(d.pageY-j.pos.y)>j.threshold)&&j.apply()}if(f){g||(g=!0,f.show(),f.$current.addClass(f.$sortable.options.placeholderClass),f.$sortable.element.children().addClass(f.$sortable.options.childClass),a("html").addClass(f.$sortable.options.dragMovingClass));var e=f.data("mouse-offset"),h=parseInt(c.originalEvent.pageX,10)+e.left,i=parseInt(c.originalEvent.pageY,10)+e.top;f.css({left:h,top:i}),i<b.$win.scrollTop()?b.$win.scrollTop(b.$win.scrollTop()-Math.ceil(f.height()/2)):i+f.height()>window.innerHeight+b.$win.scrollTop()&&b.$win.scrollTop(b.$win.scrollTop()+Math.ceil(f.height()/2))}}),b.$html.on("mouseup touchend",function(){!g&&i&&(location.href=i.attr("href")),j=i=!1}),b.sortable}),$.loadingIndicator();var warehouse_item_dlg=UIkit.modal("#warehouse_item_dlg"),current_collection;$("#btn_descitem_add").click(function(){for(var a='<tr class="uk-form"><td><input type="text" class="uk-width-1-1"></td>',b=0;b<locales.length;b++)a+='<td><input type="text" class="uk-width-1-1"></td>';a+='<td style="text-align:right"><button class="uk-button uk-button-danger taracot-warehouseconf-descitem-delete"><i class="uk-icon-trash-o"></i></button></td></tr>',$("#warehouseconf_descitems_tb").append(a),$(".taracot-warehouseconf-descitem-delete").unbind(),$(".taracot-warehouseconf-descitem-delete").click(btn_taracot_descitem_delete_handler),$("#warehouseconf_descitems").show()}),$("#btn_collection_add").click(function(){var a='<tr class="uk-form"><td style="width:150px"><input type="text" class="uk-width-1-1"></td><td class="uk-sortable"></td>';a+='<td style="text-align:right;width:80px"><button class="uk-button taracot-warehouseconf-collections-add"><i class="uk-icon-plus"></i></button>&nbsp;<button class="uk-button uk-button-danger taracot-warehouseconf-collections-delete"><i class="uk-icon-trash-o"></i></button></td></tr>',$("#warehouseconf_collections_tb").append(a),$(".taracot-warehouseconf-collections-delete").unbind(),$(".taracot-warehouseconf-collections-delete").click(btn_taracot_collection_delete_handler),$(".taracot-warehouseconf-collections-add").unbind(),$(".taracot-warehouseconf-collections-add").click(btn_taracot_collection_add_handler),$("#warehouseconf_collections").show()}),$("#btn_currency_add").click(function(){for(var a='<tr class="uk-form"><td><input type="text" class="uk-width-1-1"></td><td><input type="text" class="uk-width-1-1"></td>',b=0;b<locales.length;b++)a+='<td><input type="text" class="uk-width-1-1"></td>';a+='<td style="width:40px"><button class="uk-button uk-button-danger taracot-warehouseconf-curs-delete"><i class="uk-icon-trash-o"></i></button>&nbsp;<button class="uk-button taracot-btn-curs-sort"><i class="uk-icon uk-icon-unsorted"></i></button></td></tr>',$("#warehouseconf_curs_tb").append(a),$(".taracot-warehouseconf-curs-delete").unbind(),$(".taracot-warehouseconf-curs-delete").click(btn_taracot_curs_delete_handler),$("#warehouseconf_curs").show(),UIkit.sortable($("#warehouseconf_curs_tb"),{dragCustomClass:"uk-form",handleClass:"taracot-btn-curs-sort"})}),$("#btn_ship_add").click(function(){for(var a='<tr class="uk-form"><td><input type="text" class="uk-width-1-1"></td><td><input type="text" class="uk-width-1-1"></td><td><input type="text" class="uk-width-1-1"></td><td><input type="text" class="uk-width-1-1"></td>',b=0;b<locales.length;b++)a+='<td><input type="text" class="uk-width-1-1"></td>';a+='<td style="width:60px" nowrap><button class="uk-button uk-button-danger taracot-warehouseconf-ship-delete"><i class="uk-icon-trash-o"></i></button>&nbsp;<button class="uk-button taracot-btn-ship-sort"><i class="uk-icon uk-icon-unsorted"></i></button></td></tr>',$("#warehouseconf_ship_tb").append(a),$(".taracot-warehouseconf-ship-delete").unbind(),$(".taracot-warehouseconf-ship-delete").click(btn_taracot_ship_delete_handler),$("#warehouseconf_ship").show(),UIkit.sortable($("#warehouseconf_ship_tb"),{dragCustomClass:"uk-form",handleClass:"taracot-btn-ship-sort"})});var btn_taracot_descitem_delete_handler=function(){confirm(_lang_vars.confirm_delete_descitem)&&$(this).parent().parent().remove(),$("#warehouseconf_descitems tr").length>1?$("#warehouseconf_descitems").show():$("#warehouseconf_descitems").hide()},btn_taracot_curs_delete_handler=function(){confirm(_lang_vars.confirm_delete_descitem)&&$(this).parent().parent().remove(),$("#warehouseconf_curs tr").length>1?$("#warehouseconf_curs").show():$("#warehouseconf_curs").hide()},btn_taracot_collection_delete_handler=function(){confirm(_lang_vars.confirm_delete_descitem)&&$(this).parent().parent().remove(),$("#warehouseconf_collections tr").length>1?$("#warehouseconf_collections").show():$("#warehouseconf_collections").hide()},btn_taracot_ship_delete_handler=function(){confirm(_lang_vars.confirm_delete_descitem)&&$(this).parent().parent().remove(),$("#warehouseconf_ship tr").length>1?$("#warehouseconf_ship").show():$("#warehouseconf_ship").hide()},btn_taracot_collection_add_handler=function(){var a=_get_items_array(),b="",c=[];for(var d in a)c.push([a[d].id,a[d][current_locale]]);c.sort(function(a,b){return a=a[1],b=b[1],b>a?-1:a>b?1:0});for(var e=0;e<c.length;e++){var f=c[e][0],g=c[e][1],h=g||f;b+='<div class="taracot-dlg-item" id="_di_'+f+'">'+h+"</div>"}$("#warehouse_items").html(b),$(".taracot-dlg-item").unbind(),$(".taracot-dlg-item").click(taracot_dlg_item_click_hanlder),current_collection=$(this).parent().parent(),warehouse_item_dlg.show()},taracot_dlg_item_click_hanlder=function(){warehouse_item_dlg.hide();var a='<li class="uk-badge uk-badge-success uk-badge-notification taracot-warehouse-item-notification" rel="'+$(this).attr("id").replace(/^_di_/,"")+'"><span>'+$(this).html()+'</span>&nbsp;<span><a class="uk-close taracot-warehouse-colitem-del"></a></span></li>';current_collection.children("td").eq(1).append(a),UIkit.sortable(current_collection.children("td").eq(1),{dragCustomClass:"sortable-dragged-coll"}),$(".taracot-warehouse-colitem-del").unbind(),$(".taracot-warehouse-colitem-del").click(taracot_warehouse_colitem_del_handler)},taracot_warehouse_colitem_del_handler=function(){$(this).parent().parent().remove()};$("#btn_save").click(function(){$.loadingIndicator("show");var a=_get_items_array(),b=_get_collections_array(),c=_get_curs_array(),d=_get_ship_array(),e=_get_misc_array();$.ajax({type:"POST",url:"/cp/warehouseconf/config/save",data:{descitems:a,collections:b,curs:c,ship:d,misc:e},dataType:"json",success:function(a){$.loadingIndicator("hide"),UIkit.notify(a.status&&1==a.status?{message:_lang_vars.save_success,status:"success",timeout:2e3,pos:"top-center"}:{message:_lang_vars.ajax_failed,status:"danger",timeout:2e3,pos:"top-center"})},error:function(){$.loadingIndicator("hide"),UIkit.notify({message:_lang_vars.ajax_failed,status:"danger",timeout:2e3,pos:"top-center"})}})});var _get_items_array=function(){var a=[],b=0,c={};return $("#warehouseconf_descitems_tb  > tr > td").each(function(){return 0===b&&(c.id=$(this).children().first().val()),b>0&&b<=locales.length&&(c[locales[b-1]]=$(this).children().first().val()),b>locales.length?(a.push(c),b=0,void(c={})):void b++}),a},_get_collections_array=function(){var a=[],b=0,c={};return $("#warehouseconf_collections_tb  > tr > td").each(function(){return 0===b&&(c.id=$(this).children().first().val()),1===b&&(c.items=[],$(this).children().each(function(){c.items.push($(this).attr("rel"))})),2===b?(a.push(c),b=0,void(c={})):void b++}),a},_get_curs_array=function(){var a=[],b=0,c={};return $("#warehouseconf_curs_tb  > tr > td").each(function(){return 0===b&&(c.id=$(this).children().first().val()),1===b&&(c.exr=$(this).children().first().val()),b>1&&b<=locales.length+1&&(c[locales[b-2]]=$(this).children().first().val()),b>locales.length+1?(a.push(c),b=0,void(c={})):void b++}),a},_get_ship_array=function(){var a=[],b=0,c={};return $("#warehouseconf_ship_tb  > tr > td").each(function(){return 0===b&&(c.id=$(this).children().first().val()),1===b&&(c.weight=$(this).children().first().val()),2===b&&(c.amnt=$(this).children().first().val()),3===b&&(c.price=$(this).children().first().val()),b>3&&b<=locales.length+3&&(c[locales[b-4]]=$(this).children().first().val()),b>locales.length+3?(a.push(c),b=0,void(c={})):void b++}),a},_get_misc_array=function(){var a=[],b=0,c={},d=0;return $("#warehouseconf_misc_tb  > tr > td").each(function(){return 0===b&&0===d&&(c.id="weight_units"),b>0&&b<=locales.length&&(c[locales[b-1]]=$(this).children().first().val()),b>=locales.length?(a.push(c),b=0,c={},void d++):void b++}),a};$(document).ready(function(){$("#warehouseconf_descitems_tb  > tr").each(function(){$(this).remove()}),$("#warehouseconf_collections_tb  > tr").each(function(){$(this).remove()});for(var a=0;a<init_items.length;a++)$("#btn_descitem_add").click();for(var b=0;b<init_collections.length;b++)$("#btn_collection_add").click();for(var c=0;c<init_curs.length;c++)$("#btn_currency_add").click();for(var d=0;d<init_ship.length;d++)$("#btn_ship_add").click();var e=0,f=0;$("#warehouseconf_descitems_tb  > tr > td").each(function(){var a=init_items[f];return a&&(0===e&&$(this).children().first().val(a.id),e>0&&e<=locales.length&&$(this).children().first().val(a[locales[e-1]])),e>locales.length?(e=0,void f++):void e++}),e=0,f=0;for(var g=_get_items_array(),h={},i=0;i<g.length;i++)h[g[i].id]=g[i][current_locale]||g[i].id;$("#warehouseconf_collections_tb  > tr > td").each(function(){if(0===e&&$(this).children().first().val(init_collections[f].id),1===e&&init_collections[f].items){for(var a=0;a<init_collections[f].items.length;a++){var b='<div class="uk-badge uk-badge-success uk-badge-notification taracot-warehouse-item-notification" rel="'+init_collections[f].items[a]+'"><span>'+h[init_collections[f].items[a]]+'</span>&nbsp;<span><a class="uk-close taracot-warehouse-colitem-del"></a></span></div>';$(this).append(b)}UIkit.sortable($(this),{dragCustomClass:"sortable-dragged-coll"}),$(".taracot-warehouse-colitem-del").unbind(),$(".taracot-warehouse-colitem-del").click(taracot_warehouse_colitem_del_handler)}return 2===e?(e=0,void f++):void e++}),e=0,f=0,$("#warehouseconf_curs_tb  > tr > td").each(function(){var a=init_curs[f];return a&&(a.exr||(a.exr=""),0===e&&$(this).children().first().val(a.id),1===e&&$(this).children().first().val(a.exr),e>1&&e<=locales.length+1&&$(this).children().first().val(a[locales[e-2]])),e>locales.length+1?(e=0,void f++):void e++}),e=0,f=0,$("#warehouseconf_ship_tb  > tr > td").each(function(){var a=init_ship[f];return a&&(a.exr||(a.exr=""),0===e&&$(this).children().first().val(a.id),1===e&&$(this).children().first().val(a.weight),2===e&&$(this).children().first().val(a.amnt),3===e&&$(this).children().first().val(a.price),e>3&&e<=locales.length+3&&$(this).children().first().val(a[locales[e-4]])),e>locales.length+3?(e=0,void f++):void e++}),e=0,f=0,$("#warehouseconf_misc_tb  > tr > td").each(function(){var a=init_misc[f];return a&&e>0&&e<=locales.length&&$(this).children().first().val(a[locales[e-1]]),e>locales.length?(e=0,void f++):void e++})});