var edit_modal=new UIkit.modal("#taracot-modal-edit"),current_id="",process_rows=[function(a,b){return'<label><input type="checkbox" class="taracot-table-chbx" id="taracot-table-chbx-'+b+'" rel="taracot-item_'+a+'"></div>&nbsp;'+a+"</label>"},function(a){return null===a&&(a="&mdash;"),a},function(a){return'<div style="text-align:center">'+a+"</div>"},function(a,b){return'<div style="text-align:center"><button class="uk-icon-button uk-icon-edit taracot-tableitem-edit" id="taracot-btnedt-'+b+'" type="button"></button>&nbsp;<button class="uk-icon-button uk-icon-button-danger uk-icon-trash-o taracot-tableitem-delete" id="taracot-btndel-'+b+'" type="button"></button></div>'}];$("#btn-select-all").click(function(){$(".taracot-table-chbx").prop("checked",!0)}),$("#btn-select-none").click(function(){$(".taracot-table-chbx").prop("checked",!1)}),$("#btn-delete-selected").click(function(){var a=[];$(".taracot-table-chbx").each(function(b,c){$(c).prop("checked")&&a.push($(c).attr("id").replace("taracot-table-chbx-",""))}),a.length>0&&delete_item(a)}),$("#btn-add-item").click(function(){$("#taracot-modal-edit-h1-edit").addClass("uk-hidden"),$("#taracot-modal-edit-h1-add").removeClass("uk-hidden"),add_item()});var load_edit_data=function(a){$.ajax({type:"POST",url:"/cp/settings/data/load",data:{id:a},dataType:"json",success:function(a){$("#taracot-modal-edit-loading").addClass("uk-hidden"),1==a.status?($("#taracot-modal-edit-wrap").removeClass("uk-hidden"),void 0!==typeof a.data&&(void 0!==typeof a.data.oname&&$("#oname").val(a.data.oname),void 0!==typeof a.data.ovalue&&$("#ovalue").val(a.data.ovalue),void 0!==typeof a.data.olang&&$("#olang").val(a.data.olang)),$("#oname").focus()):$("#taracot-modal-edit-loading-error").removeClass("uk-hidden")},error:function(){$("#taracot-modal-edit-loading").addClass("uk-hidden"),$("#taracot-modal-edit-loading-error").removeClass("uk-hidden")}})},edit_item=function(a){current_id=a,edit_modal.show(),$(".taracot-edit-field").removeClass("uk-form-danger"),$(".taracot-edit-field").val(""),$("#taracot-modal-edit-wrap").addClass("uk-hidden"),$("#taracot-modal-edit-loading").removeClass("uk-hidden"),$("#taracot-modal-edit-loading-error").addClass("uk-hidden"),load_edit_data(a)},add_item=function(){current_id="",edit_modal.show(),$("#taracot-modal-edit-wrap").removeClass("uk-hidden"),$("#taracot-modal-edit-loading").addClass("uk-hidden"),$("#taracot-modal-edit-loading-error").addClass("uk-hidden"),$(".taracot-edit-field").removeClass("uk-form-danger"),$(".taracot-edit-field").val(""),$("#status").val("1"),$("#oname").focus()};$("#taracot-edit-btn-save").click(function(){$(".taracot-edit-field").removeClass("uk-form-danger");var a=!1;return $("#oname").val().match(/^[A-Za-z0-9_\-]{3,20}$/)||($("#oname").addClass("uk-form-danger"),a=!0),$("#ovalue").val().match(/^.{0,255}$/)||($("#ovalue").addClass("uk-form-danger"),a=!0),a?void UIkit.notify({message:_lang_vars.form_err_msg,status:"danger",timeout:2e3,pos:"top-center"}):($("#taracot-modal-edit-wrap").addClass("uk-hidden"),$("#taracot-modal-edit-loading").removeClass("uk-hidden"),$("#taracot-modal-edit-loading-error").addClass("uk-hidden"),void $.ajax({type:"POST",url:"/cp/settings/data/save",data:{oname:$("#oname").val(),ovalue:$("#ovalue").val(),olang:$("#olang").val(),id:current_id},dataType:"json",success:function(a){if($("#taracot-modal-edit-loading").addClass("uk-hidden"),1==a.status)$("#taracot_table").medvedTable("update"),edit_modal.hide(),UIkit.notify({message:_lang_vars.save_success,status:"success",timeout:2e3,pos:"top-center"});else{$("#taracot-modal-edit-wrap").removeClass("uk-hidden");var b=_lang_vars.form_err_msg;if(a.error&&(b=a.error),a.err_fields&&a.err_fields.length)for(var c=!1,d=0;d<a.err_fields.length;d++)$("#"+a.err_fields[d]).addClass("uk-form-danger"),c||($("#"+a.err_fields[d]).focus(),c=!0);UIkit.notify({message:b,status:"danger",timeout:2e3,pos:"top-center"})}},error:function(){$("#taracot-modal-edit-loading").addClass("uk-hidden"),$("#taracot-modal-edit-wrap").removeClass("uk-hidden"),UIkit.notify({message:_lang_vars.form_err_msg,status:"danger",timeout:2e3,pos:"top-center"})}}))});var delete_item=function(a){for(var b=[],c=0;c<a.length;c++)b.push($("#taracot-table-chbx-"+a[c]).attr("rel").replace("taracot-item_",""));confirm(_lang_vars.del_confirm+"\n\n"+b.join(", "))&&($("#taracot_table").medvedTable("loading_indicator_show"),$.ajax({type:"POST",url:"/cp/settings/data/delete",data:{ids:a},dataType:"json",success:function(a){$("#taracot_table").medvedTable("loading_indicator_hide"),1==a.status?$("#taracot_table").medvedTable("update"):UIkit.notify({message:_lang_vars.delete_err_msg,status:"danger",timeout:2e3,pos:"top-center"})},error:function(){$("#taracot_table").medvedTable("loading_indicator_hide"),UIkit.notify({message:_lang_vars.delete_err_msg,status:"danger",timeout:2e3,pos:"top-center"})}}))};$(".taracot-edit-field").bind("keypress",function(a){submitOnEnter(a)&&$("#taracot-edit-btn-save").click()}),$(document).ready(function(){$("#taracot_table").medvedTable({col_count:4,sort_mode:1,sort_cell:"oname",taracot_table_url:"/cp/settings/data/list",process_rows:process_rows,error_message:_lang_vars.ajax_failed})});