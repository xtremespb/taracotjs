$("#btn_save").attr("disabled",!0);var btn_save_click_handler=function(){taracot_ajax_progress_indicator("body",!0);var a=codemirror.getValue();$.ajax({type:"POST",url:"/cp/textedit/data/save",data:{fn:file.name,content:a},dataType:"json",success:function(a){if(taracot_ajax_progress_indicator("body",!1),a&&1==a.status)$.UIkit.notify({message:_lang_vars.document_saved,status:"success",timeout:2e3,pos:"top-center"}),$("#btn_save").attr("disabled",!0);else{var b=_lang_vars.ajax_failed;a.error&&(b=a.error),$.UIkit.notify({message:b,status:"danger",timeout:2e3,pos:"top-center"})}},error:function(){taracot_ajax_progress_indicator("body",!1),$.UIkit.notify({message:_lang_vars.ajax_failed,status:"danger",timeout:2e3,pos:"top-center"})}})},btn_cancel_click_handler=function(){($("#btn_save").attr("disabled")||confirm(_lang_vars.cancel_confirm))&&window.close()};$(window).bind("beforeunload",function(){return $("#btn_save").attr("disabled")?void 0:!1}),$("#btn_save").click(btn_save_click_handler),$("#btn_cancel").click(btn_cancel_click_handler);var codemirror;$(document).ready(function(){codemirror=CodeMirror.fromTextArea(document.getElementById("cmeditor"),{lineNumbers:!0,keyMap:"sublime",autoCloseBrackets:!0,matchBrackets:!0,showCursorWhenSelecting:!0}),codemirror.on("change",function(){$("#btn_save").attr("disabled",!1)}),file.mime&&(file.mime.match("javascript")&&codemirror.setOption("mode","javascript"),file.mime.match("css")&&codemirror.setOption("mode","css"),file.mime.match("xml")&&codemirror.setOption("mode","xml"),file.mime.match("html")&&codemirror.setOption("mode","xml"))});var taracot_ajax_progress_indicator=function(a,b){if(b){var c=$(a).offset();$(".taracot-progress").css({top:c.top,left:c.left,width:$(a).width(),height:$(a).height()}),$(".taracot-progress").removeClass("uk-hidden")}else $(".taracot-progress").addClass("uk-hidden")};