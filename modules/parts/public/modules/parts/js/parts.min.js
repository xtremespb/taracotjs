var edit_modal=new $.UIkit.modal("#taracot-modal-edit"),current_id="",ckeditor,process_rows=[function(a,b){return'<label><input type="checkbox" class="taracot-table-chbx" id="taracot-table-chbx-'+b+'" rel="taracot-item_'+a+'"></div>&nbsp;'+a+"</label>"},function(a){return'<div style="text-align:center">'+a+"</div>"},function(a,b){return'<div style="text-align:center"><button class="uk-icon-button uk-icon-edit taracot-tableitem-edit" id="taracot-btnedt-'+b+'" type="button"></button>&nbsp;<button class="uk-icon-button uk-icon-button-danger uk-icon-trash-o taracot-tableitem-delete" id="taracot-btndel-'+b+'" type="button"></button></div>'}];$("#btn-select-all").click(function(){$(".taracot-table-chbx").prop("checked",!0)}),$("#btn-select-none").click(function(){$(".taracot-table-chbx").prop("checked",!1)}),$("#btn-delete-selected").click(function(){var a=[];$(".taracot-table-chbx").each(function(b,c){$(c).prop("checked")&&a.push($(c).attr("id").replace("taracot-table-chbx-",""))}),a.length>0&&delete_item(a)}),$("#btn-add-item").click(function(){$("#taracot-modal-edit-h1-edit").addClass("uk-hidden"),$("#taracot-modal-edit-h1-add").removeClass("uk-hidden"),add_item()});var load_edit_data=function(a){$.ajax({type:"POST",url:"/cp/parts/data/load",data:{id:a},dataType:"json",success:function(a){$("#taracot-modal-edit-loading").addClass("uk-hidden"),1==a.status?($("#taracot-modal-edit-wrap").removeClass("uk-hidden"),void 0!==typeof a.data&&(void 0!==typeof a.data.pname&&$("#pname").val(a.data.pname),$("#pvalue").val(void 0!==typeof a.data.pvalue?a.data.pvalue:""),void 0!==typeof a.data.plang&&$("#plang").val(a.data.plang)),$("#pname").focus()):$("#taracot-modal-edit-loading-error").removeClass("uk-hidden")},error:function(){$("#taracot-modal-edit-loading").addClass("uk-hidden"),$("#taracot-modal-edit-loading-error").removeClass("uk-hidden")}})},edit_item=function(a){current_id=a,edit_modal.show(),$("#taracot-modal-edit-wrap > form.uk-form > fieldset > div.uk-form-row > input").removeClass("uk-form-danger"),$("#taracot-modal-edit-wrap > form.uk-form > fieldset > div.uk-form-row > input").val(""),$("#taracot-modal-edit-wrap").addClass("uk-hidden"),$("#taracot-modal-edit-loading").removeClass("uk-hidden"),$("#taracot-modal-edit-loading-error").addClass("uk-hidden"),load_edit_data(a)},add_item=function(){current_id="",edit_modal.show(),$("#taracot-modal-edit-wrap").removeClass("uk-hidden"),$("#taracot-modal-edit-loading").addClass("uk-hidden"),$("#taracot-modal-edit-loading-error").addClass("uk-hidden"),$("#taracot-modal-edit-wrap > form.uk-form > fieldset > div.uk-form-row > input").removeClass("uk-form-danger"),$("#taracot-modal-edit-wrap > form.uk-form > fieldset > div.uk-form-row > input").val(""),$("#pvalue").val(""),$("#plang").val($("#plang option:first").val()),$("#pname").focus()};$("#taracot-edit-btn-save").click(function(){$("#taracot-modal-edit-wrap > form.uk-form > fieldset > div.uk-form-row > input").removeClass("uk-form-danger");var a=!1;return $("#pname").val().match(/^[A-Za-z0-9_\-]{1,40}$/)||($("#pname").addClass("uk-form-danger"),a=!0),a?void $.UIkit.notify({message:_lang_vars.form_err_msg,status:"danger",timeout:2e3,pos:"top-center"}):($("#taracot-modal-edit-wrap").addClass("uk-hidden"),$("#taracot-modal-edit-loading").removeClass("uk-hidden"),$("#taracot-modal-edit-loading-error").addClass("uk-hidden"),void $.ajax({type:"POST",url:"/cp/parts/data/save",data:{pname:$("#pname").val(),pvalue:$("#pvalue").val(),plang:$("#plang").val(),id:current_id},dataType:"json",success:function(a){if($("#taracot-modal-edit-loading").addClass("uk-hidden"),1==a.status)$("#taracot_table").medvedTable("update"),edit_modal.hide(),$.UIkit.notify({message:_lang_vars.save_success,status:"success",timeout:2e3,pos:"top-center"});else{$("#taracot-modal-edit-wrap").removeClass("uk-hidden");var b=_lang_vars.form_err_msg;if(a.error&&(b=a.error),a.err_fields&&a.err_fields.length)for(var c=!1,d=0;d<a.err_fields.length;d++)$("#"+a.err_fields[d]).addClass("uk-form-danger"),c||($("#"+a.err_fields[d]).focus(),c=!0);$.UIkit.notify({message:b,status:"danger",timeout:2e3,pos:"top-center"})}},error:function(){$("#taracot-modal-edit-loading").addClass("uk-hidden"),$("#taracot-modal-edit-wrap").removeClass("uk-hidden"),$.UIkit.notify({message:_lang_vars.form_err_msg,status:"danger",timeout:2e3,pos:"top-center"})}}))});var delete_item=function(a){for(var b=[],c=0;c<a.length;c++)b.push($("#taracot-table-chbx-"+a[c]).attr("rel").replace("taracot-item_",""));confirm(_lang_vars.del_confirm+"\n\n"+b.join(", "))&&($("#taracot_table").medvedTable("loading_indicator_show"),$.ajax({type:"POST",url:"/cp/parts/data/delete",data:{ids:a},dataType:"json",success:function(a){$("#taracot_table").medvedTable("loading_indicator_hide"),1==a.status?$("#taracot_table").medvedTable("update"):$.UIkit.notify({message:_lang_vars.delete_err_msg,status:"danger",timeout:2e3,pos:"top-center"})},error:function(){$("#taracot_table").medvedTable("loading_indicator_hide"),$.UIkit.notify({message:_lang_vars.delete_err_msg,status:"danger",timeout:2e3,pos:"top-center"})}}))};$(".taracot-edit-form > fieldset > .uk-form-row > input, .taracot-edit-form > fieldset > .uk-form-row > select").bind("keypress",function(a){submitOnEnter(a)&&$("#taracot-edit-btn-save").click()}),$(document).ready(function(){$("#taracot_table").medvedTable({col_count:3,sort_mode:1,sort_cell:"pname",taracot_table_url:"/cp/parts/data/list",process_rows:process_rows}),init_ckeditor()});var init_ckeditor=function(){ckeditor=$("#pvalue").ckeditor({filebrowserBrowseUrl:"/cp/browse",filebrowserImageBrowseUrl:"/cp/browse?io=1",filebrowserWindowWidth:800,filebrowserWindowHeight:500,allowedContent:!0}).editor};